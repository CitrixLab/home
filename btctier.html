<!DOCTYPE html>
<html>
<head>
    <title>Bitcoin Price Checker</title>
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="https://lexusvp.github.io/citrixlab/assets/css/main.css" />
    <link rel="icon" href="images/citrixlab-ico.ico" type="image/x-icon">

    <style>
        .centered-div {
            text-align: center;
        }
        .form-box {
            display: inline-block;
            padding: 10px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div class="centered-div">
        <div class="form-box">
            <p id="errormsg">...</p>
            <h1>Current Bitcoin Price</h1>
            <p id="price">Loading...</p>
            <p id="price2">Loading...</p>
            <p id="priceNew">Loading...</p>
            <p id="priceChange">Loading...</p>
            <p id="priceDate">Loading...</p>


<!-- New element for displaying new BTC price -->



            <h4>Tier 7 Trade</h4>
            <p id="t1">Loading...</p>
            <p id="tp1">Loading...</p>
            



        <script src="https://widgets.coingecko.com/coingecko-coin-price-chart-widget.js"></script>
        <coingecko-coin-price-chart-widget currency="usd" coin-id="bitcoin" locale="en" height="300"></coingecko-coin-price-chart-widget>
        </div>
    </div>

    
    <script>
        // Initialize variables
        let bitcoinPrice;
        let btcSP;
        let target1per;


        const fetchBitcoinDetails = () => {
            // Make an HTTP request to the CoinGecko API to get Bitcoin's details
            fetch('https://api.coingecko.com/api/v3/coins/bitcoin')
                .then(response => response.json())
                .then(data => {
                    const btcDetails = data;
                    const priceChange24h = btcDetails.market_data.price_change_percentage_24h;
                    const lastUpdate = new Date(btcDetails.last_updated).toLocaleString();
                    const bitcoinPriceNew = btcDetails.market_data.current_price.usd.toLocaleString();
                    
                    document.getElementById('priceNew').textContent = `Bitcoin Price (USD): $${bitcoinPrice}.00`;
                
                    document.getElementById('priceChange').textContent = `24H Percentage Change: ${priceChange24h.toFixed(2)}%`;
                
                    document.getElementById('priceDate').textContent = `Last Update: ${lastUpdate}`;
                
                })
            .catch(error => {
                // Handle any errors
                document.getElementById('errormsg').textContent = error;
        });
        // Function to fetch Bitcoin price with a 1-second delay
        const fetchBitcoinPriceDelayed = () => {
            fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd')
                .then(response => response.json())
                .then(data => {
                    // Extract the Bitcoin price from the API response
                    btcSP = data.bitcoin.usd;

                    // After both prices are available, proceed with calculations and updates
                    updateTradeInfo();
                })
                .catch(error => {
                    // Handle any errors
                    document.getElementById('errormsg').textContent = error;
                });
        };

        // Function to fetch the current BTC price with no delay
        const fetchBitcoinPrice = () => {
            fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd')
                .then(response => response.json())
                .then(data => {
                    // Extract the Bitcoin price from the API response
                    bitcoinPrice = data.bitcoin.usd;
                    const formattedPrice4 = bitcoinPrice.toLocaleString();

                    // Update the HTML element with the current Bitcoin price
                    document.getElementById('price').textContent = `Bitcoin Price: $${formattedPrice4}`;
                    
                    // Additional line to display the new BTC price
                    const formattedPrice3 = btcSP.toLocaleString();
                    document.getElementById('price2').textContent = `BTC new price: $${formattedPrice3}`;
                })
                .catch(error => {
                    // Handle any errors
                    document.getElementById('errormsg').textContent = error;
                });
        };

        // Fetch the current BTC price with no delay and set a 10-second delay for the other
        fetchBitcoinPrice();
        setTimeout(fetchBitcoinPriceDelayed, 1000);

        // Function to update trade information
        const updateTradeInfo = () => {
            // Bitcoin price is a numeric value
            const originalPrice = btcSP;
            const increasedPrice = originalPrice * 1.005; // Adding 0.5%

            target1per = ((originalPrice / increasedPrice) - 1) * 100;

            // Format the increasedPrice with commas
            const formattedPrice1 = increasedPrice.toLocaleString();
            const formattedPrice2 = target1per.toLocaleString();

            document.getElementById('t1').textContent = `Trade No.1: $${formattedPrice1}`;
            document.getElementById('tp1').textContent = `Trade No.1 Target Percentage: ${formattedPrice2}%`;
            
            document.getElementById('errormsg').textContent = ". . .";
                
        };

        // Update btcSP and call updateTradeInfo every 0.5 seconds
        setInterval(() => {
            fetchBitcoinPrice();
            updateTradeInfo();
            fetchBitcoinDetails();
        }, 1000);
    </script>
</body>
</html>
